!function(t){var i,e,s=['<div id="timepicker" style="opacity:0">','<div id="timepicker-time">','<span id="timepicker-hour"></span>',":",'<span id="timepicker-minute"></span>',"</div>",'<div id="timepicker-canvas">','<div id="timepicker-faceH"></div>','<div id="timepicker-faceM"></div>',"</div>","</div>"].join(""),a=['<div id="timepicker-buttons">','<span id="timepicker-cancel-button"></span>','<span id="timepicker-done-button"></span>',"</div>"].join(""),n=['<div id="am_pm">','<span id="ampm_button"></span>',"</div>"].join(""),h=400,o=3.5,r=2.5,c=function(t){return parseInt(t+Math.random()*t)},m=function(t){return t=t.toString(),t.length<2&&10>t?"0"+t:t},d="ontouchstart"in window,p="mousedown"+(d?" touchstart":""),u="mousemove"+(d?" touchmove":""),f="mouseup"+(d?" touchend":""),l=function(i,e){{var h=this,o=t(s),r=t(n),m="INPUT"===i.prop("tagName"),d=o.find("span#timepicker-hour"),p=o.find("span#timepicker-minute"),u=o.find("#timepicker-canvas"),f=o.find("#timepicker-faceH"),l=o.find("#timepicker-faceM"),w=m?i:i.find("input");parseInt(u.css("width"),10)}if(this.id=c(1e3),this.time_h=d,this.time_m=p,this.face_canvas=u,this.face_h=f,this.face_m=l,this.arrow,this.meridiem="AM",this.isOpen=!1,this.isCreated=!1,this.isRotated,this.ampm=r,this.currentView="",this.settings=e,this.input=w,this.fragment=o,e.enable_buttons){var g=t(a);g.find("#timepicker-done-button").html(e.done_text).on("click.done_"+this.id,t.proxy(this.done,this)),!e.always_show&&g.find("#timepicker-cancel-button").html(e.cancel_text).on("click.cancel_"+this.id,t.proxy(this.hide,this)),g.appendTo(o)}e.twelve_hour&&(r.appendTo(o.find("#timepicker-time")),r.find("#ampm_button").html(h.meridiem).on("click.ampm_"+this.id,function(){h.meridiem="AM"==h.meridiem?"PM":"AM",t(this).html(h.meridiem)})),"dark"==e.theme&&o.addClass("timepicker-dark"),e.always_show?this.show():w.on("click.timepicker_"+this.id+" focusin.timepicker_"+this.id,t.proxy(this.show,this))};l["default"]={time:"06:00",autohide:!1,autotogle:!0,enable_buttons:!0,always_show:!1,twelve_hour:!1,position:"bottom","float":"center",margin:15,theme:"light",done_text:"Done",cancel_text:"Cancel"},l.prototype.show=function(){var i,e=[];this.isOpen||("now"!=this.settings.time||this.input.val()?(e=this.input.val()||this.settings.time,e=e.split(/[\:\ \-]/),("AM"==e[2]||"PM"==e[2])&&(this.meridiem=e[2]),e[0]>24&&(e[0]-=24),e[1]>60&&(e[1]-=60),!this.settings.twelve_hour&&"PM"==this.meridiem&&e[0]<13&&(e[0]=parseInt(e[0])+12),this.settings.twelve_hour&&e[0]>12&&(e[0]=parseInt(e[0]-12),this.meridiem="PM"),e[0]=m(e[0]),e[1]=m(e[1])):(i=new Date,e[0]=m(i.getHours()),e[1]=m(i.getMinutes()),this.settings.twelve_hour&&(this.meridiem=e[0]>11?"PM":"AM",e[0]=e[0]>12||0==e[0]?Math.abs(e[0]-12):e[0])),this.isCreated||(this.fragment.appendTo("body").addClass("timepicker_"+this.id),this.drawNum(),this.isCreated=!0,this.time_h.on("click.timeH_"+this.id,t.proxy(this.toggleView,this,"hour")),this.time_m.on("click.timeM_"+this.id,t.proxy(this.toggleView,this,"minute")),t(window).on("resize.timepicker_"+this.id,t.proxy(this.position,this))),this.time_h.html(e[0]),this.time_m.html(e[1]),this.ampm.find("#ampm_button").html(this.meridiem),this.toggleView("hour"),this.fragment.css({display:"block"}).animate({opacity:"1"},h),this.position(),this.isOpen=!0,this.settings.always_show||(t(document).on("mousedown.document.timepicker_"+this.id,function(t){this.input.is(t.target)||this.fragment.is(t.target)||0!==this.fragment.has(t.target).length||this.isRotated||this.hide()}.bind(this)),t(document).on("keyup",function(t){27==t.keyCode&&this.hide()}.bind(this))))},l.prototype.hide=function(){this.fragment.animate({opacity:"0"},h),setTimeout(function(){this.fragment.css({display:"none"})}.bind(this),h),this.isOpen=!1,t(document).off("mousedown.document.timepicker_"+this.id)},l.prototype.position=function(){var t,i,e=this.input,s=this.settings.position,a=this.settings["float"],n=this.settings.margin,h=e.offset().top,o=e.offset().left,r=e.outerWidth(),c=e.outerHeight(),m=this.fragment.outerHeight(),d=this.fragment.outerWidth();switch(s){case"bottom":t=h+c+n;break;case"top":t=h-m-n;break;case"left":i=o-d-n;break;case"right":i=o+r+n;break;default:t=h+c+n}switch(a){case"bottom":t=h;break;case"top":t=h-m+c;break;case"left":i=o;break;case"right":i=o-d+r;break;case"center":"top"===s||"bottom"===s?i=o+(r-d)/2:t=h+(c-m)/2;break;default:i=o+(r-d)/2}this.fragment.css({top:t,left:i})},l.prototype.drawNum=function(){var s,a,n,h,c=this.face_canvas.width(),m=this.face_canvas.height(),d=c/8,l=m/8;if(this.settings.twelve_hour)for(var w=1;13>w;w++)h=r,a=-Math.cos(w*Math.PI/6)*m/h+m/2-l/2,s=Math.sin(w*Math.PI/6)*c/h+c/2-d/2,n=t("<span data="+w+">"+w+"</span>").css({top:a+"px",left:s+"px",width:d+"px","line-height":l+"px"}),this.face_h.append(n);else for(var w=0;24>w;w++)h=0==w||w>12?r:o,a=-Math.cos(w*Math.PI/6)*m/h+m/2-l/2,s=Math.sin(w*Math.PI/6)*c/h+c/2-d/2,n=t("<span data="+w+">"+w+"</span>").css({top:a+"px",left:s+"px",width:d+"px","line-height":l+"px"}),(0==w||w>12)&&n.addClass("outerH"),this.face_h.append(n);for(var w=0;60>w;w+=5)h=r,a=-Math.cos(w*Math.PI/30)*m/h+m/2-l/2,s=Math.sin(w*Math.PI/30)*c/h+c/2-d/2,n=t("<span data="+w+">"+w+"</span>").css({top:a+"px",left:s+"px",width:d+"px","line-height":l+"px"}),this.face_m.append(n);i=[c/o-d/2,c/o+d/2],e=[c/r-d/2,c/r+d/2],this.arrow=this.face_canvas.children().is("#arrow")?this.face_canvas.find("#arrow"):t('<div id="arrow" style="opacity:0"></div>').appendTo(this.face_canvas),this.face_canvas.on(p+".canvas_"+this.id,function(i){this.moveArrow(i),this.isRotated||t(document).on(u+".canvas_"+this.id,t.proxy(this.moveArrow,this)),this.isRotated=!0}.bind(this)),t(document).on(f+".canvas_"+this.id,function(){t(document).off(u+".canvas_"+this.id),this.isRotated&&this.settings.autotogle&&this.toggleView("auto"),this.isRotated=!1}.bind(this))},l.prototype.moveArrow=function(t){t.preventDefault();var s,a,n,h,o,r,c,d,p,u=/^touch/.test(t.type),f=this.face_canvas,l=f.width(),w=f.height();if(s=f.offset().left+l/2,a=f.offset().top+w/2,n=(u?t.originalEvent.touches[0]:t).pageX-s,h=(u?t.originalEvent.touches[0]:t).pageY-a,r=Math.sqrt(n*n+h*h),r>i[0]&&r<i[1])c="inner";else{if(!(r>e[0]))return;c="outer"}o=180*Math.atan2(h,n)/Math.PI,o=0>o?o+=360:o,o=o>270?o-270:o+90,"hour"!=this.currentView||this.settings.twelve_hour?"hour"==this.currentView&&this.settings.twelve_hour?(d=Math.round(o/30),d=0==d?12:d,this.drawArrow(e[0],"hour12",d),this.time_h.html(m(d))):"minute"==this.currentView&&(p=Math.round(o/6),p=60==p?0:p,this.drawArrow(e[0],"minute",p),this.time_m.html(m(p))):("inner"==c?(d=Math.round(o/30),d=0==d?12:d,this.drawArrow(i[0],"hour",d)):(d=Math.round(o/30)+12,d=24==d||12==d?0:d,this.drawArrow(e[0],"hour",d)),this.time_h.html(m(d)))},l.prototype.drawArrow=function(t,i,e){var s,a=1;"angle"==i&&(a=1),("hour"==i||"hour12"==i)&&(a=30),"minute"==i&&(a=6),s=e*a,t=parseInt(t),this.arrow.css({"margin-top":"-"+t+"px","padding-top":t+"px",transform:"rotate("+s+"deg)"})},l.prototype.done=function(){var t=this.time_h.html()+":"+this.time_m.html();this.input.val(this.settings.twelve_hour?t+" "+this.meridiem:t),!this.settings.always_show&&this.hide()},l.prototype.toggleView=function(t){var s,a=parseInt(this.time_h.html()),n=parseInt(this.time_m.html());if(t!=this.currentView){if("toggle"==t&&this.toggleView("hour"==this.currentView?"minute":"hour"),"auto"==t)return void("hour"==this.currentView?this.toggleView("minute"):"minute"==this.currentView&&this.settings.autohide&&this.done());"hour"==t&&(s=this.settings.twelve_hour?e:a>12?e:i,setTimeout(function(){this.face_m.css({"z-index":1}),this.drawArrow(s,"hour",a),this.arrow.animate({opacity:1},h)}.bind(this),h),this.face_m.animate({transform:"scale(5)",opacity:0},h),this.arrow.animate({opacity:0},h),this.face_h.css({"z-index":10}).animate({transform:"scale(1)",opacity:1},h),this.time_m.removeClass("active"),this.time_h.addClass("active"),this.currentView="hour"),"minute"==t&&(setTimeout(function(){this.face_h.css({"z-index":1}),this.drawArrow(e,"minute",n),this.arrow.animate({opacity:1},h)}.bind(this),h),this.face_h.animate({transform:"scale(5)",opacity:0},h),this.arrow.animate({opacity:0},h),this.face_m.css({"z-index":10}).animate({transform:"scale(1)",opacity:1},h),this.time_h.removeClass("active"),this.time_m.addClass("active"),this.currentView="minute")}},t.fn.timePicker=function(i){var e=Array.prototype.slice.call(arguments,1);return this.each(function(){var s=t(this),a=s.data("timepicker");if(a)"function"==typeof a[i]&&a[i].apply(a,e);else{var n=t.extend({},l["default"],s.data(),"object"==typeof i&&i);s.data("timepicker",new l(s,n))}})}}(jQuery);